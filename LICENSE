src/emd.h and src/emd.cpp are from http://ai.stanford.edu/~rubner/